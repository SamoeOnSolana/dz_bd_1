@page
@model App1.Pages.Orders1.IndexModel
@{
    ViewData["Title"] = "Замовлення";
}

<div class="container mx-auto p-6">
    <h1 class="text-3xl font-bold text-gray-800 mb-6">Замовлення</h1>

    <form method="get" class="mb-6 bg-white p-4 rounded-lg shadow">
        <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
            <div>
                <input type="text" name="SearchName" value="@Model.SearchName" placeholder="Пошук за іменем клієнта" class="w-full px-3 py-2 border border-gray-300 rounded-md" />
            </div>
            <div>
                <select name="SortBy" class="w-full px-3 py-2 border border-gray-300 rounded-md">
                    <option value="">Сортування</option>
                    <option value="date" selected="@(Model.SortBy == "date")">За датою (зростання)</option>
                    <option value="datedesc" selected="@(Model.SortBy == "datedesc")">За датою (спадання)</option>
                </select>
            </div>
            <div>
                <button type="submit" class="w-full bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600">Пошук</button>
            </div>
        </div>
    </form>

    <div class="bg-white rounded-lg shadow overflow-hidden">
        <table class="min-w-full divide-y divide-gray-200">
            <thead class="bg-gray-50">
                <tr>
                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">ID</th>
                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Дата</th>
                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Клієнт</th>
                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Товари</th>
                </tr>
            </thead>
            <tbody class="bg-white divide-y divide-gray-200">
                @foreach (var order in Model.Orders)
                {
                    <tr>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">@order.Id</td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">@order.OrderDate.ToString("dd.MM.yyyy")</td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">@order.CustomerName</td>
                        <td class="px-6 py-4 text-sm text-gray-900">
                            @foreach (var op in order.OrderProducts)
                            {
                                <div>@op.Product.Title - @op.Quantity шт.</div>
                            }
                        </td>
                    </tr>
                }
            </tbody>
        </table>
    </div>

    <div class="mt-4 flex justify-between items-center">
        <div>
            Сторінка @Model.PageNumber з @Model.TotalPages (всього: @Model.TotalCount)
        </div>
        <div class="flex gap-2">
            @if (Model.PageNumber > 1)
            {
                <a href="?PageNumber=@(Model.PageNumber - 1)&SearchName=@Model.SearchName&SortBy=@Model.SortBy" class="bg-gray-500 text-white px-4 py-2 rounded hover:bg-gray-600">Назад</a>
            }
            @if (Model.PageNumber < Model.TotalPages)
            {
                <a href="?PageNumber=@(Model.PageNumber + 1)&SearchName=@Model.SearchName&SortBy=@Model.SortBy" class="bg-gray-500 text-white px-4 py-2 rounded hover:bg-gray-600">Вперед</a>
            }
        </div>
    </div>
</div>
